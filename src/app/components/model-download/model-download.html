<div class="model-download-container">
  
  <!-- Model Ready State -->
  <div *ngIf="isModelReady" class="status-card ready">
    <div class="status-icon">‚úÖ</div>
    <h3>AI Intelligence Module Ready</h3>
    <p>Your offline AI coach is ready to help! All conversations happen privately on your device.</p>
  </div>

  <!-- Download Prompt -->
  <div *ngIf="showDownloadPrompt && !hasError" class="status-card prompt">
    <div class="status-icon">üß†</div>
    <h3>Download AI Intelligence Module</h3>
    <p>To enable offline AI coaching, download the intelligence module (~{{ getModelSize() }} MB).</p>
    
    <div class="download-info">
      <div class="info-item">
        <span class="info-icon">üîí</span>
        <span>Completely offline and private</span>
      </div>
      <div class="info-item">
        <span class="info-icon">‚ö°</span>
        <span>Background download (won't interrupt usage)</span>
      </div>
      <div class="info-item">
        <span class="info-icon">üíæ</span>
        <span>Cached for future use</span>
      </div>
    </div>

    <div class="download-actions">
      <button 
        class="download-btn primary" 
        (click)="downloadModel()"
        [disabled]="!backgroundFetchSupported">
        Download Now
      </button>
      
      <div *ngIf="!backgroundFetchSupported" class="browser-warning">
        <span class="warning-icon">‚ö†Ô∏è</span>
        <span>Background downloads not supported in this browser. Please use Chrome or Edge.</span>
      </div>
    </div>
  </div>

  <!-- Download in Progress -->
  <div *ngIf="isDownloading" class="status-card downloading">
    <div class="status-icon">
      <div class="spinner"></div>
    </div>
    <h3>Downloading AI Intelligence Module</h3>
    <p>This happens in the background. You can continue using the app while it downloads.</p>
    
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="getProgressPercentage()"></div>
      </div>
      <div class="progress-text">{{ getProgressPercentage() }}%</div>
    </div>
    
    <div class="download-size">
      {{ getModelSize() }} MB ‚Ä¢ Background Download Active
    </div>
  </div>

  <!-- Download Complete -->
  <div *ngIf="status.isComplete && !isModelReady" class="status-card complete">
    <div class="status-icon">üéâ</div>
    <h3>Download Complete!</h3>
    <p>AI Intelligence Module downloaded successfully. Initializing...</p>
    <div class="initializing">
      <div class="spinner small"></div>
      <span>Setting up your AI coach...</span>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="hasError" class="status-card error">
    <div class="status-icon">‚ùå</div>
    <h3>Download Failed</h3>
    <p>{{ errorMessage }}</p>
    
    <div class="error-actions">
      <button class="download-btn secondary" (click)="retryDownload()">
        Try Again
      </button>
    </div>
    
    <div class="troubleshooting">
      <h4>Troubleshooting Tips:</h4>
      <ul>
        <li>Check your internet connection</li>
        <li>Ensure you have enough storage space (~{{ getModelSize() }} MB)</li>
        <li>Try using Chrome or Edge browser</li>
        <li>Disable VPN or proxy if enabled</li>
      </ul>
    </div>
  </div>

</div>
